!function(t,o){"function"==typeof define&&define.amd?define(o):"object"==typeof exports?module.exports=o():t.returnExports=o()}(window,function(){var t=function(t,o){var e=this;e.isScrollBody=!t||"body"===t,e.scrollDom=e.isScrollBody?document.body:e.getDomById(t),e.options=o||{};var n=navigator.userAgent,r=!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),s=void 0===window.orientation,i=n.indexOf("Android")>-1||n.indexOf("Adr")>-1;if(e.os={ios:r,pc:s,android:i},e.isDownScrolling=!1,e.isUpScrolling=!1,e.xTranScroll(),e.options.yScroll&&e.options.xScroll)return console.log("上下拉， 左右滑不能同时进行"),"上下拉， 左右滑不能同时进行";if(e.options.yScroll)e.scrollDom.className="plyscroll plScroll",e.initDownScroll(),e.initUpScroll();else{if(!e.options.xScroll)return console.log("未定义滑动方向"),"未定义滑动方向";e.scrollDom.className="plxscroll plScroll plscroll-hardware",e.initLeftRightScroll()}};return t.prototype.extendUpScroll=function(o){t.extend(o,{use:!0,toTop:{src:null,offset:200,warpClass:"plscroll-totop",showClass:"plscroll-fade-in",hideClass:"plscroll-fade-out",duration:300,fadeDuration:.5}})},t.prototype.extendDownScroll=function(o){t.extend(o,{warpClass:"plscroll-downwarp",resetClass:"plscroll-downwarp-reset",htmlContent:'<p class="downwarp-progress"></p><p class="downwarp-tip"></p>',outOffsetRate:.2,offset:80,minAngle:45,bottomOffset:20,hardwareClass:"plscroll-hardware",textInOffset:"下拉刷新",textOutOffset:"释放更新",textLoading:"加载中 ...",use:!0,inited:function(t,o){t.downTipDom=o.getElementsByClassName("downwarp-tip")[0],t.downProgressDom=o.getElementsByClassName("downwarp-progress")[0]},inOffset:function(t){t.downTipDom&&(t.downTipDom.innerHTML=t.optDown.textInOffset),t.downProgressDom&&t.downProgressDom.classList.remove("plScroll-rotate")},onMoving:function(t,o,e){if(t.downProgressDom){var n=360*o;t.downProgressDom.style.webkitTransform="rotate("+n+"deg)",t.downProgressDom.style.transform="rotate("+n+"deg)"}},outOffset:function(t){t.downTipDom&&(t.downTipDom.innerHTML=t.optDown.textOutOffset)},beforeLoading:function(t,o){return!1},showLoading:function(t){t.downTipDom&&(t.downTipDom.innerHTML=t.optDown.textLoading),t.downProgressDom&&t.downProgressDom.classList.add("plscroll-rotate")},afterLoading:function(t){return 0},callback:function(t){}})},t.prototype.initUpScroll=function(){var t=this;t.optUp=t.options.up,t.extendUpScroll(t.optUp);var o=t.scrollDom.firstChild;o.id="contentBox",t.touchstartEvent=function(o){t.isScrollTo&&t.preventDefault(o),t.startPoint=t.getPoint(o),t.lastPoint=t.startPoint;var e=document.body.clientHeight||document.documentElement.clientHeight;t.maxTouchmoveY=e-t.optDown.bottomOffset},t.scrollDom.addEventListener("touchstart",t.touchstartEvent),t.touchmoveEvent=function(e){var n=t.getScrollDistance("y");t.scrollDom.offsetHeight,o.offsetHeight;t.inTouchend=!1;var r=t.getPoint(e),s=r.y-t.startPoint.y;if(s>0){if(n<=0&&(t.preventDefault(e),t.optDown.use&&!t.inTouchend&&!t.isDownScrolling)){var i=Math.abs(t.lastPoint.x-r.x),l=Math.abs(t.lastPoint.y-r.y),a=Math.sqrt(i*i+l*l);if(0!==a)if(Math.asin(l/a)/Math.PI*180<t.optDown.minAngle)return;if(t.maxTouchmoveY>0&&r.y>=t.maxTouchmoveY)return t.inTouchend=!0,void t.touchendEvent();var c=r.y-t.lastPoint.y;t.downHight||(t.downHight=0),t.downHight<t.optDown.offset?(1!==t.movetype&&(t.movetype=1,t.optDown.inOffset(t),t.downwarp.classList.remove(t.optDown.resetClass),t.isMoveDown=!0,t.os.ios&&(t.scrollDom.classList.add(t.optDown.hardwareClass),t.scrollDom.style.webkitOverflowScrolling="auto",t.isSetScrollAuto=!0)),t.downHight+=c):(2!==t.movetype&&(t.movetype=2,t.optDown.outOffset(t),t.downwarp.classList.remove(t.optDown.resetClass),t.isMoveDown=!0,t.os.ios&&(t.scrollDom.classList.add(t.optDown.hardwareClass),t.scrollDom.style.webkitOverflowScrolling="auto",t.isSetScrollAuto=!0)),t.downHight+=c>0?c*t.optDown.outOffsetRate:c),t.downwarp.style.height=t.downHight+"px";var p=t.downHight/t.optDown.offset;t.optDown.onMoving(t,p,t.downHight)}}else if(s<0){t.scrollDom.scrollHeight-t.scrollDom.clientHeight-n<=0&&t.preventDefault(e)}t.lastPoint=r},t.scrollDom.addEventListener("touchmove",t.touchmoveEvent,{passive:!1}),t.touchendEvent=function(o){t.optDown.use&&t.isMoveDown&&(t.downHight>=t.optDown.offset?t.triggerDownScroll():(t.downwarp.classList.add(t.optDown.resetClass),t.downHight=0,t.downwarp.style.height=0),t.isSetScrollAuto&&(t.scrollDom.style.webkitOverflowScrolling="touch",t.scrollDom.classList.remove(t.optDown.hardwareClass),t.isSetScrollAuto=!1),t.movetype=0,t.isMoveDown=!1)},t.scrollDom.addEventListener("touchend",t.touchendEvent),t.scrollDom.addEventListener("touchcancel",t.touchendEvent)},t.prototype.resetUpScroll=function(t){this.optUp&&this.optUp.use},t.prototype.triggerDownScroll=function(){this.optDown.beforeLoading(this,this.downwarp)||(this.showDownScroll(),this.optDown.callback&&this.optDown.callback(this))},t.prototype.endDownScroll=function(){var t=this,o=function(){t.downHight=0,t.downwarp.style.height=0,t.isDownScrolling=!1,t.downProgressDom&&t.downProgressDom.classList.remove("plscroll-rotate")},e=t.optDown.afterLoading(t);"number"==typeof e&&e>0?setTimeout(o,e):o()},t.prototype.showDownScroll=function(){this.isDownScrolling=!0,this.optDown.showLoading(this),this.downHight=this.optDown.offset,this.downwarp.classList.add(this.optDown.resetClass),this.downwarp.style.height=this.optDown.offset+"px"},t.prototype.initDownScroll=function(){var t=this;t.optDown=t.options.down,t.extendDownScroll(t.optDown),t.optDown.use&&(t.downwarp=document.createElement("div"),t.downwarp.className=t.optDown.warpClass,t.downwarp.innerHTML='<div class="downwarp-content">'+t.optDown.htmlContent+"</div>",t.scrollDom.insertBefore(t.downwarp,t.scrollDom.firstChild),setTimeout(function(){t.optDown.inited(t,t.downwarp)},0)),t.scrollDom.addEventListener("scroll",function(o){var e=t.getScrollDistance("y");"function"==typeof t.optUp.onScroll&&t.optUp.onScroll(t,e);var n=t.optUp.toTop;n.src&&(e>=n.offset?t.showTopBtn():t.hideTopBtn())})},t.prototype.getPoint=function(t){return{x:t.touches?t.touches[0].pageX:t.clientX,y:t.touches?t.touches[0].pageY:t.clientY}},t.prototype.showTopBtn=function(){if(!this.topBtnShow){this.topBtnShow=!0;var t=this,o=t.optUp.toTop;null==t.toTopBtn&&(t.toTopBtn=document.createElement("img"),t.toTopBtn.src=o.src,t.toTopBtn.className=o.warpClass,document.body.appendChild(t.toTopBtn),t.toTopBtn.onclick=function(){t.scrollTo(0,o.duration)}),t.toTopBtn.classList.remove(o.hideClass),t.toTopBtn.classList.add(o.showClass),t.toTopBtn.style.animationDuration=o.fadeDuration,t.toTopBtn.style.webkitAnimationDuration=o.fadeDuration}},t.prototype.hideTopBtn=function(){if(this.topBtnShow&&this.toTopBtn){this.topBtnShow=!1;var t=this.optUp.toTop;this.toTopBtn.classList.remove(this.optUp.toTop.showClass),this.toTopBtn.classList.add(this.optUp.toTop.hideClass),this.toTopBtn.style.animationDuration=t.fadeDuration,this.toTopBtn.style.webkitAnimationDuration=t.fadeDuration}},t.prototype.scrollTo=function(t,o){var e=this,n=e.getScrollDistance("y"),r=t;if(r>0){var s=e.scrollDom.scrollHeight-e.scrollDom.clientHeight;r>s&&(r=s)}else r=0;e.isScrollTo=!0,e.scrollDom.style.webkitOverflowScrolling="auto",e.getStep(n,r,function(t){e.scrollDom.scrollTop=t,t===r&&(e.scrollDom.style.webkitOverflowScrolling="touch",e.isScrollTo=!1)},o)},t.prototype.getStep=function(t,o,e,n,r){var s=o-t;if(0===n||0===s)return e&&e(o),"";var i=(n=n||300)/(r=r||30),l=s/i,a=0,c=window.setInterval(function(){a<i-1?(t+=l,e&&e(t,c),a++):(e&&e(o,c),window.clearInterval(c))},r)},t.prototype.extendLeftRightScroll=function(o){t.extend(o,{springback:!0,springbackNum:150,scrollbar:!0})},t.extend=function(o,e){if(!o)return e;for(var n in e)null==o[n]?o[n]=e[n]:"object"==typeof o[n]&&t.extend(o[n],e[n]);return o},t.prototype.initLeftRightScroll=function(){var t=this;t.optLeftRight=t.options.LeftRight,t.extendLeftRightScroll(t.optLeftRight);var o=t.scrollDom.firstChild,e=o.offsetWidth;if(t.optLeftRight.scrollbar){var n=document.createElement("div");n.id="conBox",t.scrollDom.parentNode.insertBefore(n,t.scrollDom),n.appendChild(t.scrollDom);var r=t.scrollDom.offsetHeight-o.offsetHeight+10;t.scrollDom.style.top=r+"px",t.scrollDom.style.marginTop=-r+"px"}t.xInitParameters={transitionTime:".5",xstart:0,xdifference:0,xisMove:!1,xmaxTranslate:0,xminTranslate:t.scrollDom.offsetWidth-o.offsetWidth,moveX:0},t.scrollDom.addEventListener("scroll",function(o){if("function"==typeof t.optLeftRight.onScroll){var e=t.getScrollDistance("x");t.optLeftRight.onScroll(t,e)}});var s=!0,i=-1,l=!0,a=-1;t.scrollDom.addEventListener("touchstart",function(o){t.xInitParameters.xstart=o.touches[0].clientX}),t.scrollDom.addEventListener("touchmove",function(n){if(t.scrollDom.offsetWidth-o.offsetWidth<0){t.xInitParameters.xisMove=!0;var r=t.getScrollDistance("x"),c=n.touches[0].clientX;t.xInitParameters.xdifference=c-t.xInitParameters.xstart;var p=Math.abs(t.xInitParameters.xminTranslate),d=Math.abs(t.xInitParameters.xminTranslate)+t.optLeftRight.springbackNum;if(t.optLeftRight.springback&&t.os.android){if(t.removeTransition(o),r<=0&&t.xInitParameters.xdifference>0){if(s&&(i=t.xInitParameters.xdifference,s=!1),Math.abs(t.xInitParameters.xdifference)-Math.abs(i)<=t.optLeftRight.springbackNum){var f=i>=0?t.xInitParameters.xdifference-i:t.xInitParameters.xdifference;t.translateX(o,f)}Math.abs(t.xInitParameters.xdifference)-Math.abs(i)>t.optLeftRight.springbackNum&&t.translateX(o,t.optLeftRight.springbackNum)}else if(d>=r&&r>=p&&t.xInitParameters.xdifference<0){l&&(a=t.xInitParameters.xdifference,l=!1);var m=Math.abs(t.xInitParameters.xdifference)-Math.abs(a);m<=t.optLeftRight.springbackNum?(o.style.width=e+Math.abs(m)+"px",t.scrollDom.scrollLeft=Math.abs(t.xInitParameters.xminTranslate)+Math.abs(m)):m>t.optLeftRight.springbackNum&&(o.style.width=e+t.optLeftRight.springbackNum+"px",t.scrollDom.scrollLeft=Math.abs(t.xInitParameters.xminTranslate)+t.optLeftRight.springbackNum)}}else!1===t.optLeftRight.springback&&(t.xInitParameters.xdifference>0?r<=0&&t.preventDefault(n):t.xInitParameters.xdifference<0&&r>=p&&t.preventDefault(n));window.addEventListener("touchmove",t.bounceTouchmove,{passive:!1})}}),t.scrollDom.addEventListener("touchend",function(n){t.xInitParameters.xisMove&&(t.optLeftRight.springback&&(!1===s?(t.translateX(o,0),t.addTransition(o,!1,parseFloat(t.xInitParameters.transitionTime)+"s"),s=!0,i=-1):!1===l&&(o.style.width=e+"px",t.addTransition(o,"width",parseFloat(t.xInitParameters.transitionTime)+"s"),l=!0,a=-1)),t.xInitParameters.xisMove=!1,window.removeEventListener("touchmove",t.bounceTouchmove))})},t.prototype.preventDefault=function(t){t&&t.cancelable&&!t.defaultPrevented&&t.preventDefault()},t.prototype.bounceTouchmove=function(t){for(var o=t.target,e=!0;o!==document.body&&o!==document;){var n=o.classList;if(n&&n.contains("plxscroll")){e=!1;break}o=o.parentNode}e&&t.preventDefault()},t.prototype.getDomById=function(t){var o;return t&&("string"==typeof t?o=document.getElementById(t):t.nodeType&&(o=t)),o||console.error("id为: "+t+"找不到"),o},t.prototype.getScrollDistance=function(t){if(this.isScrollBody){if("x"===t)return document.documentElement.scrollLeft||document.body.scrollLeft;if("y"===t)return document.documentElement.scrollTop||document.body.scrollTop}else{if("x"===t)return this.scrollDom.scrollLeft;if("y"===t)return this.scrollDom.scrollTop}},t.prototype.xTranScroll=function(){this.translateX=function(t,o){t.style.transform="translateX("+o+"px)",t.style.webkitTransform="translateX("+o+"px)"},this.translateY=function(t,o){t.style.transform="translateY("+o+"px)",t.style.webkitTransform="translateY("+o+"px)"},this.removeTransition=function(t){t.style.transition="none",t.style.webkitTransition="none"},this.addTransition=function(t,o,e){t.style.transition=o?o+" "+e:e,t.style.webkitTransition=o?o+" "+e:e}},t.prototype.destroy=function(){var t=this;t.scrollDom.removeEventListener("touchstart",t.touchstartEvent),t.scrollDom.removeEventListener("touchmove",t.touchmoveEvent),t.scrollDom.removeEventListener("touchend",t.touchendEvent),t.removeChild(t.toTopBtn)},t.prototype.removeChild=function(t){if(t){var o=t.parentNode;o&&o.removeChild(t),t=null}},t});